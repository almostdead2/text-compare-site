<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Text Compare Site</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    .container { display: flex; gap: 1rem; }
    textarea { width: 100%; }
    button { padding: 0.5rem 1rem; border-radius: 8px; margin-top: 1rem; }
    #result { white-space: pre-wrap; font-family: monospace; margin-top: 1rem; }
    .added { background: #7aff7a; }
    .removed { background: #ff7a7a; text-decoration: line-through; }
    .result-container div.panel { border: 1px solid #ddd; padding: 0.75rem; font-family: monospace; white-space: pre-wrap; }
  </style>

  <!-- Only necessary addition: diff-match-patch library (enables huge text support) -->
  <script src="https://unpkg.com/diff-match-patch"></script>
</head>
<body>
  <h1>Text Compare Site</h1>

  <div class="container">
    <div style="flex:1">
      <h3>Text 1</h3>
      <textarea id="text1" style="width:100%; height:180px; border-radius:12px;"></textarea>
    </div>
    <div style="flex:1">
      <h3>Text 2</h3>
      <textarea id="text2" style="width:100%; height:180px; border-radius:12px;"></textarea>
    </div>
  </div>

  <button onclick="compareText()">Compare</button>

  <div class="result-container" style="display:flex; gap:1rem; margin-top:1rem;">
    <div style="flex:1;">
      <h3>Text 1</h3>
      <div class="panel">
        <div id="result-left"></div>
      </div>
    </div>
    <div style="flex:1;">
      <h3>Text 2</h3>
      <div class="panel">
        <div id="result-right"></div>
      </div>
    </div>
  </div>

  <script>
    function escapeHtml(s){
      return s.replace(/&/g,'&amp;')
              .replace(/</g,'&lt;')
              .replace(/>/g,'&gt;');
    }

    function compareText() {
      const a = document.getElementById('text1').value;
      const b = document.getElementById('text2').value;

      const dmp = new diff_match_patch();
      const diffs = dmp.diff_main(a, b);
      dmp.diff_cleanupSemantic(diffs);

      let left = "";
      let right = "";

      for (const [op, text] of diffs) {
        const safe = escapeHtml(text);

        if (op === 0) { // no change
          left += safe;
          right += safe;
        }
        else if (op === -1) { // removed from Text 1
          left += `<span class="removed">${safe}</span>`;
          right += safe.replace(/\S/g, ' ');
        }
        else if (op === 1) { // added to Text 2
          right += `<span class="added">${safe}</span>`;
          left += safe.replace(/\S/g, ' ');
        }
      }

      document.getElementById('result-left').innerHTML = left;
      document.getElementById('result-right').innerHTML = right;
    }
  </script>

</body>
</html>
